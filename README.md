# S-P500_Stock_Daily_Analysis
Daily analysis and selection of 500 S&amp;P 500 stock based on moving average, MACD, boilinger bands, RSI, MSI and other indicators.

The first constant is window_sizes, which is a dictionary containing the window sizes for different technical indicators, such as upper band, middle band, lower band, exponential moving averages (EMAs), simple moving averages (SMAs), and Hull moving average (HMA). Each indicator has its own window size, which is specified as the value in the dictionary.

The second constant is weights, which is a dictionary that assigns weights to different technical indicators. The weights are used to calculate the final score of each stock in the trading algorithm. The higher the weight, the more important the indicator is in calculating the score. For example, the upper band, middle band, lower band, relative strength index (RSI), and money flow index (MFI) all have a weight of 2, while some moving averages have a weight of 1 or 2.

Finally, the tickers500 constant is a list of 500 stock tickers. This list is used as the universe of stocks to analyze in the trading algorithm. The list contains some of the largest and most actively traded stocks in the U.S. market.

The defined functions are:

download(ticker): This function takes a stock ticker as input and uses the Yahoo Finance API to download historical stock data for the past 250 days. The data is returned as a Pandas DataFrame.

calculate_TA(ticker_data_1): This function takes the stock data downloaded by download() as input and calculates various technical indicators for the stock, such as the Relative Strength Index (RSI), the Money Flow Index (MFI), Bollinger Bands, Simple Moving Averages (SMAs), Exponential Moving Averages (EMAs), and Hull Moving Averages (HMA). It then applies a set of weights to each indicator based on predefined buy and sell signals, and generates a "TA_Buy" and "TA_Sell" column in the DataFrame indicating whether each data point corresponds to a buy or sell signal.

get_recommendation(ticker): This function takes a stock ticker as input and uses the calculate_TA() function to generate buy and sell signals for the stock. It then calculates the percentage of buy signals versus sell signals, and returns a recommendation to either buy, hold, or sell the stock based on this percentage.

The function calculate_KNN takes in ticker_data_3 as input, which is a Pandas dataframe containing the historical price data of a stock. It first creates a copy of the input dataframe, then loops over a set of window sizes defined in window_sizes_knn. For each window size, the function trains a K-Nearest Neighbors (KNN) regressor on the closing prices of the stock, and uses it to make predictions for the next 5 time steps. If the maximum predicted price for the next 5 time steps is less than 1.15 times the current closing price of the stock, the function considers it a buying opportunity and increments the count_buy variable. If the minimum predicted price for the next 5 time steps is less than 0.85 times the current closing price of the stock, the function considers it a selling opportunity and increments the count_sell variable. The function then adds the count_buy and count_sell variables to the corresponding columns of the copied dataframe, and computes the total number of buy and sell signals by adding up the technical analysis (TA) and KNN buy/sell signals. Finally, the function returns a subset of the copied dataframe containing the closing price, TA buy/sell signals, KNN buy/sell signals, total buy/sell signals, and the total signal.

The macd_signal function takes in the output of calculate_KNN as input, which is a Pandas dataframe containing the buy/sell signals computed by the previous function. It computes the Moving Average Convergence Divergence (MACD) indicator using the closing price of the stock, with fast and slow exponential moving averages (EMAs) of length 12 and 26 respectively, and a signal line EMA of length 9. The function then compares the current MACD value with the current signal line value to determine the last signal, which can be 'Buy', 'Sell', or None. Finally, the function returns the last signal.

It imports necessary libraries and defines some variables for later use. It reads a CSV file called "movement.csv" that contains information about the movement of the stocks. It loops through a list of stocks called "tickers500". For each stock, it reads a CSV file called "status.csv" that contains information about the status of the stock such as whether it is being traded or not. It downloads data for the stock using the "download" function, and then performs technical analysis using functions called "macd_signal" and "calculate_TA" and "calculate_KNN". It checks if the stock meets certain conditions to make a trade. If it does, it updates the "status.csv" file with the new trade information.After going through all stocks, it updates the "movement.csv" file with the new movement information, calculates the total profit, and sends an email with the buy and sell information and total profit.
